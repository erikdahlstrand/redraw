{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 71250c9028e74acb63dc","webpack:///./src/js/redraw.js","webpack:///./src/js/browser-api.js","webpack:///./src/js/canvas-wrapper.js","webpack:///./src/js/canvas-const.js","webpack:///./src/js/event-aggregator.js","webpack:///./src/js/controls/controls-dispatcher.js","webpack:///./src/js/tools/arrow-tool.js","webpack:///./src/js/tools/delete-tool.js","webpack:///./src/js/tools/horizontal-line-tool.js","webpack:///./src/js/tools/pixelate-tool.js","webpack:///./src/js/tools/rectangle-tool.js","webpack:///./src/js/tools/reset-tool.js","webpack:///./src/js/tools/text-tool.js","webpack:///./src/js/tools/setup/arrow-setup.js","webpack:///./src/js/tools/setup/delete-setup.js","webpack:///./src/js/tools/setup/horizontal-line-setup.js","webpack:///./src/js/tools/setup/pixelate-setup.js","webpack:///./src/js/tools/setup/rectangle-setup.js","webpack:///./src/js/tools/setup/reset-setup.js","webpack:///./src/js/tools/setup/text-setup.js"],"names":[],"mappings":"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","file":"redraw.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rechart\"] = factory();\n\telse\n\t\troot[\"rechart\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 71250c9028e74acb63dc\n **/","import Browser from './browser-api.js';\nimport Canvas from './canvas-wrapper.js';\nimport EventAggregator from './event-aggregator.js';\nimport ControlsDispatcher from './controls/controls-dispatcher.js';\n\n/**\n * Namespace-root, that will be set to window-Object.\n * @access private\n */\nvar redrawNs = {\n    tools: {}\n};\n\n/**\n * Makes a blob from eg base64-string.\n * @access private\n * @param data {string} encodedData - to encode\n * @returns {Blob} results\n */\nfunction dataURItoBlob(encodedData) {\n    var decodedData = atob(encodedData.split(',')[1]);\n    var array = []; // 8-bit unsigned array\n    for (var i = 0; i < decodedData.length; i++) {\n        array.push(decodedData.charCodeAt(i));\n    }\n    return new Blob([new Uint8Array(array)], {\n        type: 'image/png'\n    });\n}\n\n/**\n * If the user has defined the options.tools, then use this to\n * extract the sepcified subset from allTools.\n * @access private\n * @param {Object[]} allTools - should be tools to pick from.\n * @param {Object} options - with or without property tools.\n * @returns {Object} containing all or the selected tools.\n */\nfunction getToolsFromUserSettings(allTools, options) {\n\n    if (options && options.tools) {\n        var definedTools = {};\n        for (let t in options.tools) {\n            let toolName = options.tools[t];\n            definedTools[toolName] = allTools[toolName];\n        }\n        return definedTools;\n    } else {\n        return allTools;\n    }\n}\n\n/**\n * Defines the options-properties allowed to infect all tools-settings.\n * @access private\n */\nvar globalOverrides = ['color', 'activeColor'];\n\n/**\n * Figures out which options should be applied for a particular toolName.\n * @access private\n * @param {Object} allProps - already defined options, that shold not be lost, but perhaps\n * replaced if defined in precedenceProps or globalOptions.\n * @param {Object} precedenceProps - that may have a property named toolName, that will\n * replace options from allProps.\n * @param {Object} globalOptions - top-level options that will overwrite allProp but not precedenceProps\n * @param {string} toolName - name of the tool, which options is processed\n * @returns {Object} with tool applies options\n */\nfunction overwriteProps(allProps, precedenceProps, globalOptions, toolName) {\n    var results = {};\n\n    for (var p in allProps[toolName].options) {\n        if (allProps[toolName].options.hasOwnProperty(p)) {\n            if (precedenceProps[toolName] && precedenceProps[toolName] && precedenceProps[toolName].hasOwnProperty(p)) {\n                results[p] = precedenceProps[toolName][p];\n            } else if (globalOverrides.indexOf(p) > -1 && globalOptions.hasOwnProperty(p)){\n                results[p] = globalOptions[p];\n            } else {\n                results[p] = allProps[toolName].options[p];\n            }\n        }\n    }\n    return results;\n}\n\n/**\n * Main module, and the only public api for usage.\n * @module redraw\n */\nclass Redraw {\n    /**\n     * Redraw constructor. Bootstraps the canvas and tools.\n     * @constructor\n     * @param {Object} imgElement - The dom element that holds the image.\n     * @param {Object} options - Options.\n     */\n    constructor(imgElement, options) {\n        this.events = new EventAggregator();\n        options = options || {};\n        this._canvas = new Canvas(imgElement, this.events, options); // Needs defactor\n\n        if (options.jsonContent) {\n            this._canvas.loadFromJSON(options.jsonContent);\n        }\n\n        this.controls = this.initializeTools(this.events, options);\n    }\n    /**\n     * Get the png-representation of the canvas.\n     * @access public\n     * @returns {string} with base64 encoded png.\n     */\n    getDataUrlForExport() {\n        this._canvas.canvas.deactivateAllWithDispatch();\n        return this._canvas.canvas.toDataURL(\n            {\n                format:'png',\n                multiplier: 1/this._canvas.scale\n            });\n    }\n\n    /**\n     * Get the base64-encoded png-representation of the canvas.\n     * @access public\n     * @returns {string} with base64 encoded png.\n     */\n    toBase64URL() {\n        return this.getDataUrlForExport();\n    }\n\n    /**\n     * Get the binary png-representation of the canvas.\n     * @access public\n     * @returns {Blob} with canvas as png.\n     */\n    toDataBlob() {\n        return dataURItoBlob(this.getDataUrlForExport());\n    }\n\n    /**\n     * Get the json-representation of the canvas.\n     * @access public\n     * @param {boolean} includeImage - true if background-image should be included in the json.\n     * @returns {string} with json.\n     */\n    toJson(includeImage) {\n        this.controls.cancelActiveTool();\n        var jsObj = this._canvas.canvas.toObject(['lockMovementX', 'lockMovementY',\n            'lockRotation', 'lockScalingX', 'lockScalingY', 'lockUniScaling',\n            'hasControls', 'hasRotatingPoint', 'selectable', 'fill', 'padding']);\n\n\n        if (!includeImage) {\n            delete jsObj.backgroundImage;\n        }\n        return JSON.stringify(jsObj);\n    }\n\n    /**\n     * Resets image and loads content from provided json.\n     * @access public\n     * @param {string} jsonRepresentation - to provide as current state of the canvas.\n     */\n    fromJson(jsonRepresentation) {\n        this._canvas.loadFromJSON(jsonRepresentation);\n    }\n\n    /**\n     * Tells whether or not any objects are present in the canvas, i.e. arrows, rectangles other than the image itself.\n     * @access public\n     * @returns {boolean} true if there are obejcts, i.e.\n     */\n    isEmpty() {\n        return (this._canvas.getAllObjects().length === 0);\n    }\n\n    isDirty() {\n        return true;\n    }\n\n\n    /**\n     * Returns the canvas representation, as is from Fabric.js\n     * @access public\n     * @returns {Object} canvas, see http://fabricjs.com/.\n     */\n    getCanvas() {\n        return this._canvas.canvas;\n    }\n\n    on(topic, callbackFn, subscriberId, scope) {\n        this.events.subscribeTo(topic, 'cx-' + subscriberId, callbackFn, scope);\n    }\n\n    off(topic, subscriberId) {\n        this.events.unsubscribeTo(topic, 'cx-' + subscriberId);\n    }\n\n    /**\n     * Initializes all selected tools.\n     * @param {EventAggregator} events - used for all mediated communications.\n     * @param {Object} options - settings for all tools.\n     */\n    initializeTools(events, options) {\n        var localToolSettings = {};\n        options.toolSettings = options.toolSettings || {};\n        var toolsInUse = getToolsFromUserSettings(redrawNs.tools, options);\n\n        for (var toolName in toolsInUse) {\n            var passedProps = overwriteProps(redrawNs.tools, options.toolSettings, options, toolName);\n\n            redrawNs.tools[toolName].options = passedProps;\n\n            new redrawNs.tools[toolName].toolFn(this._canvas, events, passedProps);\n        }\n        var controls = new ControlsDispatcher(events, options);\n        controls.setupTools(toolsInUse, this._canvas.canvasContainer, options);\n        return controls;\n    }\n}\n\nredrawNs.Annotation = Redraw;\n/**\n * Used by tools to register themselves to be available for usage.\n * @access public\n * @param {string} _name - name of tool.\n * @param {function(canvas: CanvasWrapper, events: EventAggregator, passedProps: Object)} _toolFn - callback function, invoked upon initialization of the tools.\n * @param {Object} _options - options, to be used as default ones.\n */\nredrawNs.registerTool = function(_name, _toolFn, _options) {\n    redrawNs.tools[_name] = {\n        address: _name,\n        toolFn: _toolFn,\n        options: _options\n    };\n    // buttonCss is an attribute that applies to all tools\n    redrawNs.tools[_name].options.buttonCss = redrawNs.tools[_name].options.buttonCss ||Â '';\n};\n\n(new Browser()).appendToWindow('redraw', redrawNs);\n\n\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/redraw.js\n **/","var isBrowser = typeof window !== 'undefined';\n\n/**\n * Facade of the browser apis. The main purpose id to facilitate testing.\n */\nexport default class Browser {\n    /**\n     * Contructor that determines if there is a browser present.\n     * @constructor\n     */\n    constructor() {\n        this.document = isBrowser ? document : {};\n        this.window = isBrowser ? window : {};\n    }\n\n    /**\n     * Appends property to the browser window object.\n     * @param {string} attributeName - Name of the property to create/assign.\n     * @param {Object} obj - value to set.\n     */\n    appendToWindow(attributeName, obj) {\n\n        if (isBrowser) {\n            window[attributeName] = obj;\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Use to retrieve property from the browser window object.\n     * @param {string} attributeName - Name of the property to create/assign.\n     * @returns {Object} obj - retrieved value, or mock if not browser.\n     */\n    getFromWindow(attributeName) {\n        if (window) {\n            return window[attributeName];\n        }\n      return {\n        getFromWindow:function() { },\n          tools: []};\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/browser-api.js\n **/","import CONST from './canvas-const.js';\n\n /**\n * Gets the scroll position of a dom element.\n * @access private\n * @param {Object} elem - target element.\n */\nfunction scrollPosition(elem) {\n    var left = 0,\n        top = 0;\n\n    do {\n        left += elem.scrollLeft;\n        top += elem.scrollTop;\n    } while (elem = elem.offsetParent);\n\n    return [left, top];\n}\n\n/**\n * Canvas object that facilitates\n */\nexport default class Canvas {\n     /**\n     * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n     * @constructor\n     * @param {Object} imgElement - dom element that will be replaced and\n     * used as background for canvas.\n     * @param {EventAggregator} eventAggregator - Event mediator.\n     * @param {Object} options - parameters used to setup looks and all tools preferences.\n     */\n    constructor(imgElement, eventAggregator, options) {\n        this.options = options;\n        this.eventAggregator = eventAggregator;\n        var parent = imgElement.parentNode;\n        var redrawWrapper = document.createElement('div');\n        redrawWrapper.className = CONST.CSS.PARENT;\n        this.scale = 1;\n        parent.insertBefore(redrawWrapper, imgElement);\n        parent.removeChild(imgElement);\n\n        var canvasElem = document.createElement('canvas');\n        let canvasWrapper = document.createElement('div');\n        canvasWrapper.className = CONST.CSS.CANVAS_WRAPPER;\n        canvasWrapper.appendChild(canvasElem);\n        redrawWrapper.appendChild(canvasWrapper);\n\n        this.canvasElem = canvasElem;\n\n        this.canvasContainer = redrawWrapper;\n        this.canvasLeft = canvasElem.offsetLeft;\n        this.canvas = new fabric.Canvas(canvasElem);\n        this.imgElement = imgElement;\n\n        /* wait until the image is surely loaded to make the setup */\n        let theCanvas = this;\n        let delayedSetup = function () {\n            theCanvas.setupImage();\n        };\n        var tmp = new Image();\n        tmp.addEventListener('load', delayedSetup, false);\n        tmp.src = this.imgElement.src;\n    }\n\n    setupImage() {\n        this.image = new fabric.Image(this.imgElement);\n        if (this.options.maxWidth && this.options.maxWidth < this.image.width) {\n            this.scale = this.options.maxWidth / this.image.width;\n        }\n        if (this.options.maxHeight && this.options.maxHeight < this.image.height) {\n            let scaleY = this.options.maxHeight / this.image.height;\n            if (this.scale > scaleY) {\n                this.scale = scaleY;\n            }\n        }\n\n        this.width = this.scale * this.imgElement.width;\n        this.height = this.scale * this.imgElement.height;\n\n        this.canvas.setDimensions({\n            width: this.width,\n            height: this.height\n        });\n\n        this.image.setScaleX(this.scale);\n        this.image.setScaleY(this.scale);\n        var event = this.eventAggregator;\n        function getBinder(_canvas) {\n            return function(){\n                _canvas.renderAll();\n                event.notify('canvas-loaded', 'CANVAS');\n            };\n        }\n        this.canvas.setBackgroundImage(this.image, getBinder(this.canvas), {});\n\n        if (this.options.maxWidth && this.options.maxWidth < this.image.width) {\n            this.scale = this.options.maxWidth / this.image.width;\n        }\n        if (this.options.maxHeight && this.options.maxHeight < this.image.height) {\n            let scaleY = this.options.maxHeight / this.image.height;\n            if (this.scale > scaleY) {\n                this.scale = scaleY;\n            }\n        }\n\n        this.eventAggregator.subscribeTo('TOOL_USAGE', 'toolbar',\n            function(subscriptionId, sender, status) {\n                if (status === 'active') {\n                    this.canvas.defaultCursor='crosshair';\n                } else {\n                    this.canvas.defaultCursor='default';\n                }\n            }, this);\n    }\n\n    loadFromJSON(jsonContent) {\n        this.canvas.clear();\n        this.canvas.loadFromJSON(jsonContent, this.canvas.renderAll.bind(this.canvas));\n    }\n\n    /**\n     * Gets the top position of the canvas dom element.\n     * @access public\n     * @returns {number} position in pixels?\n     */\n    getCanvasTop() {\n        return this.canvasContainer.offsetTop;\n    }\n\n    /**\n     * Gets the array of all objects of the canvas.\n     * @access public\n     * @returns {Array} with canvas object, or undefined if empty.\n     */\n    getAllObjects() {\n        return this.canvas.getObjects();\n    }\n\n    /**\n     * Set/unset whether or not it is possible to select objects of the canvas.\n     * @access pulic\n     * @param {boolean} isEnabled - true if selection is enabled, false otherwise.\n     */\n    enableSelection(isEnabled) {\n        this.canvas.selection = isEnabled; // Restore fabricjs selection-box\n        this.canvas.forEachObject(function(o) {\n            o.selectable = isEnabled;\n        });\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/canvas-wrapper.js\n **/","export default {\n\tTOOL: {\n\t\tARROW: 'arrow',\n\t\tDELETE: 'delete',\n\t\tHORIZONTAL_LINE: 'horizontal_line',\n\t\tPIXELATE: 'pixelate',\n\t\tRECTANGLE: 'rectangle',\n\t\tRESET: 'reset',\n\t\tTEXT: 'text'\n\t},\n\tDEFAULT_COLOR: '#33e',\n\tCSS: {\n\t\tACTIVE_BUTTON: 'active',\n\t\tBUTTON: 'redraw_btn',\n\t\tPARENT: 'redraw_parent',\n\t\tTOOLBAR: 'redraw_toolbar',\n    CANVAS_WRAPPER: 'redraw_canvas'\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/canvas-const.js\n **/","/**\n* Mediator for events.\n*/\nexport default class EventAggregator {\n    /**\n     * Contructor that initializes internal stuff.\n     * @constructor\n     */\n    constructor() {\n        this.subscriptionsByTopic = {};\n    }\n\n    /**\n     * Registers a subscriber for a specific event topic.\n     * @param {string} topic - name of the event type / topic.\n     * @param {string} subscriberId - id the subscriber, must be unique.\n     * @param {function(topic: string, sender: string, payload: Object)} onNotifyFn - callback\n     * invoked upon when upon notification.\n     * @param {Object} [_invokationScope] - scope to be used when invoking callback.\n     */\n    subscribeTo(topic, subscriberId, onNotifyFn, _invokationScope) {\n        if (!this.subscriptionsByTopic[topic]) {\n            this.subscriptionsByTopic[topic] = [];\n        }\n\n        this.subscriptionsByTopic[topic].push({subscriber: subscriberId, callbackFn: onNotifyFn, invokationScope: _invokationScope});\n    }\n\n    // ToDo needs test\n    /**\n     * Unregisters a subscriber from a specific event topic.\n     * @param {string} topic - name of the event type / topic.\n     * @param {string} _subscriber - id the unique subscriber.\n     */\n    unsubscribeTo(topic, _subscriber) {\n        for (var j in this.subscriptionsByTopic[topic]) {\n            if (this.subscriptionsByTopic[topic][j].subscriber === _subscriber) {\n                this.subscriptionsByTopic[topic].splice(j, 1);\n            }\n        }\n    }\n\n    /**\n     * Called to notify all subscribers of this topic\n     * @param {string} topic - name of the event type / topic.\n     * @param {string} sender - address of the sender.\n     * @param {Object} payload - any data to pass to the subscriber.\n     */\n    notify(topic, sender, payload) {\n        for (var s2 in this.subscriptionsByTopic[topic]) {\n            var scope = undefined;\n            if (this.subscriptionsByTopic[topic][s2].invokationScope) {\n                scope = this.subscriptionsByTopic[topic][s2].invokationScope;\n            }\n            this.subscriptionsByTopic[topic][s2].callbackFn.apply(scope, [topic, sender, payload]);\n        }\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/event-aggregator.js\n **/","import CONST from '../canvas-const.js';\n\n/**\n * Css class for all buttons of the toolbar.\n */\nconst BUTTON_CLASS = 'redraw_btn';\n\n/**\n * Adds a class to the array of classes.\n * @private\n */\nfunction addClasses(btnObj, classes) {\n    if (!classes) return;\n    var allClasses = classes.split(' ');\n\n    allClasses.forEach((clazz) => {btnObj.classList.add(clazz);})\n}\n\n/**\n * Main manager for the toolbar.\n */\nexport default class ControlsDispatcher {\n    /**\n     * Controls contructor. Is provided with canvas-wrapper and options to initialize to toolbar.\n     * @constructor\n     * @param {EventAggregator} eventAggregator - Event mediator.\n     * @param {Object} options - from user.\n     */\n    constructor(eventAggregator, options) {\n        this.toolsInUse = {};\n        var activeTool, delBtn;\n\n        function notifyActive(topic) {\n            return function() {\n                if (activeTool) {\n                    eventAggregator.notify(activeTool, 'toolbar', 'toolbar-deactivate');\n                }\n                if (activeTool !== topic) {\n                    activeTool = topic;\n                    eventAggregator.notify(topic, 'toolbar', 'toolbar-click');\n                } else {\n                    activeTool = undefined;\n                }\n            };\n        }\n\n        this.cancelActiveTool = function() {\n\n            if (activeTool) {\n                eventAggregator.notify(activeTool, 'toolbar', 'toolbar-deactivate');\n                activeTool = undefined;\n            }\n        };\n\n        var manageKeys = function(e) {\n            if (e.keyCode === 46 || e.keyCode === 27) {\n                eventAggregator.notify('keydown', 'toolbar', e.keyCode);\n            }\n        };\n\n        window.addEventListener('keydown', manageKeys, false);\n\n        this.setupTools = function(tools, domParent, mainOptions) {\n            var container = document.createElement('div');\n\n            addClasses(container, CONST.CSS.TOOLBAR);\n            addClasses(container, options.toolbarCss);\n\n            if (mainOptions.toolbarFirst === true) {\n                domParent.insertBefore(container, domParent.firstChild);\n            } else {\n                domParent.appendChild(container);\n            }\n\n            for (var toolName in tools) {\n                var btn = document.createElement('button');\n                btn.innerHTML = tools[toolName].options.label;\n\n                btn.classList.add(CONST.CSS.BUTTON);\n\n                addClasses(btn, mainOptions.buttonCss);\n                addClasses(btn, tools[toolName].options.buttonCss);\n\n                btn.onclick = notifyActive(tools[toolName].address);\n                this.toolsInUse[tools[toolName].address] = btn;\n                container.appendChild(btn);\n            }\n\n            var btnActiveCss = mainOptions.buttonActiveCss || CONST.CSS.ACTIVE_BUTTON;\n\n            eventAggregator.subscribeTo('TOOL_USAGE', 'toolbar',\n                function(subscriptionId, sender, status) {\n                    var currTool = this.toolsInUse[sender];\n\n                    if (status !== 'active') {\n                        if (sender === activeTool) {\n                            activeTool = undefined;\n                        }\n                        currTool.classList.remove(btnActiveCss);\n                    } else {\n                        currTool.classList.add(btnActiveCss);\n                    }\n                }, this);\n\n            eventAggregator.subscribeTo('tool-enabled', 'toolbar',\n                function(subscriptionId, sender, isEnabled) {\n                    if (isEnabled) {\n                        this.toolsInUse[sender].classList.remove('disabled');\n                    } else {\n                        this.toolsInUse[sender].classList.add('disabled');\n                    }\n                }, this);\n        };\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/controls/controls-dispatcher.js\n **/","import CONST from '../canvas-const.js';\nimport Browser from '../browser-api.js';\n\n/** length of arrow head */\nvar indicationLength = 8;\n/** line used during drag n drop */\nvar line;\n\n/**\n * A tool to paint arrows.\n */\nexport default class ArrowTool {\n    /**\n     * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n     * @constructor\n     * @param {Canvas} canvasWrapper - Canvas.\n     * @param {EventAggregator} eventAggregator - Event mediator.\n     */\n    constructor(canvasWrapper, eventAggregator, toolOptions, fabric) {\n        /** eventAggregator for madiated cummunications */\n        this.eventAggregator = eventAggregator;\n        /** main api to use for canvas manipulation */\n        this.canvasWrapper = canvasWrapper;\n        /** coords for the elements of the arrow */\n        this.arrow = this.canvas = this.start = this.end = undefined;\n        /** options */\n        this.options = toolOptions;\n\n        var callee = this;\n\n        this.eventAggregator.subscribeTo(\n            CONST.TOOL.ARROW,\n            'ArrowTool',\n            function() {\n                callee.initListeners.apply(callee, arguments);\n            });\n        /** shorthand to canvas */\n        this.canvas = canvasWrapper.canvas;\n\n        this.moveFn = function(options) {\n            callee.onMove(options);\n        };\n        this.downFn = function(options) {\n            callee.onMouseDown(options);\n        };\n        this.upFn = function(options) {\n            callee.onMUP(options);\n        };\n        this.notify = function(message) {\n            this.eventAggregator.notify('TOOL_USAGE', CONST.TOOL.ARROW, message);\n        };\n\n        this.done = function() {\n            this.canvasWrapper.enableSelection(true);\n            this.removeCanvasListeners();\n            this.notify('inactive');\n        };\n    }\n\n    /**\n     * Move the head of the arrow.\n     * Cred for http://stackoverflow.com/questions/29890294/arrow-shape-using-fabricjs\n     * @private\n     * @param {Object} points - 4d.\n     */\n    moveArrowIndicator(points) {\n        var x1 = points[0],\n            y1 = points[1],\n            x2 = points[2],\n            y2 = points[3],\n\n            dx = x2 - x1,\n            dy = y2 - y1,\n\n            angle = Math.atan2(dy, dx);\n\n        angle *= 180 / Math.PI;\n        angle += 90;\n        if (this.arrow) {\n            this.canvas.remove(this.arrow);\n        }\n        this.arrow = new fabric.Triangle({\n            angle: angle,\n            fill: this.options.activeColor,\n            top: y2,\n            left: x2,\n            height: this.options.size,\n            width: this.options.size,\n            originX: 'center',\n            originY: 'center',\n            selectable: false\n        });\n\n        this.canvas.add(this.arrow);\n    }\n\n    /**\n     * Cancels this paint operation, i.e. removes any ongoing paint-objects och de-registers listeners.\n     * @private\n     */\n    abort() {\n        if (this.arrow) {\n            this.canvas.remove(this.arrow);\n            this.arrow = undefined;\n        }\n        if (line) {\n            this.canvas.remove(line);\n            line = undefined;\n        }\n        this.eventAggregator.unsubscribeTo('keydown', 'ArrowTool');\n        this.done();\n    }\n\n    /**\n     * Function callback, invoked when mouse moves, even before mouse has been pressed.\n     * @private\n     * @param {Object} options - for the event.\n     */\n    onMove(options) {\n\n        if (this.start && !this.end) {\n            let pointer = this.canvas.getPointer(options.e);\n\n            line.set({\n                'x2': pointer.x\n            });\n            line.set({\n                'y2': pointer.y\n            });\n\n            this.moveArrowIndicator([this.start.left, this.start.top, pointer.x, pointer.y]);\n        }\n\n        this.canvas.renderAll();\n    }\n\n    /**\n     * Function callback, invoked on mouse up.\n     * @private\n     * @param {Object} options - for the event.\n     */\n    onMUP(options) {\n        let pointer = this.canvas.getPointer(options.e);\n        this.end = {\n            top: pointer.y,\n            left: pointer.x\n        };\n\n        var perimeter = Math.abs(this.end.top - this.start.top) + Math.abs(this.end.left - this.start.left);\n\n        if (perimeter > 10) {\n            if (this.arrow) {\n                this.arrow.fill = this.options.color;\n            }\n            var group = new fabric.Group([line, this.arrow], {\n                hasControls: false,\n                hasBorders: true,\n                selectable: false,\n                fill: this.options.color\n            });\n            line.stroke = this.options.color;\n\n            this.canvas.add(group);\n        }\n\n        this.canvas.remove(line);\n        this.canvas.remove(this.arrow);\n        this.arrow = line = this.start = this.end = undefined;\n        this.canvas.renderAll();\n    }\n\n    /**\n     * Function callback, invoked on mouse down.\n     * @private\n     * @param {Object} options - for the event.\n     */\n    onMouseDown(options) {\n        let pointer = this.canvas.getPointer(options.e);\n        this.start = {\n            top: pointer.y,\n            left: pointer.x\n        };\n\n\n        line = new fabric.Line([this.start.left, this.start.top, this.start.left, this.start.top], {\n            strokeWidth: this.options.lineWidth,\n            stroke: this.options.activeColor,\n            originX: 'center',\n            originY: 'center',\n            hasControls: false,\n            hasBorders: true,\n            selectable: true\n        });\n\n        this.canvas.add(line);\n    }\n\n    /**\n     * Function callback, invoked when toolbar is clicked.\n     * @private\n     * @param {string} topic - .\n     * @param {string} sender - .\n     * @param {string} payload - value shold be \"toolbar-deactivate\" if tool is active.\n     */\n    initListeners(topic, sender, payload) {\n        if (payload === 'toolbar-deactivate'){\n            this.abort();\n            return;\n        }\n        var me = this;\n\n        this.eventAggregator.subscribeTo('keydown', 'ArrowTool',\n            function(topic, sender, keyCode) {\n\n                if (keyCode === 27) {\n                    me.abort.apply(me);\n                }\n            });\n        this.start = this.end = undefined;\n\n        this.canvasWrapper.enableSelection(false);\n\n        this.notify('active');\n\n        this.canvas.on('mouse:down', this.downFn);\n        this.canvas.on('mouse:move', this.moveFn);\n        this.canvas.on('mouse:up', this.upFn);\n    }\n    /**\n     * Removes listeners.\n     * @private\n     */\n    removeCanvasListeners() {\n        this.canvas.off('mouse:down', this.downFn);\n        this.canvas.off('mouse:move', this.moveFn);\n        this.canvas.off('mouse:up', this.upFn);\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/arrow-tool.js\n **/","/**\n * A tool to remove selected elements from canvas!\n */\nimport CONST from '../canvas-const.js';\nimport Browser from '../browser-api.js';\n\n/**\n * A tool to remove selected elements from canvas.\n */\nexport default class DeleteTool {\n    /**\n     * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n     * @constructor\n     * @param {Canvas} canvasWrapper - Canvas.\n     * @param {EventAggregator} eventAggregator - Event mediator.\n     */\n    constructor(canvasWrapper, eventAggregator) {\n        eventAggregator.notify('tool-enabled', CONST.TOOL.DELETE, false);\n        /**\n        * Called upon removal.\n        */\n        var remove = function() {\n            var c = canvasWrapper.canvas;\n            if (c.getActiveObject()) {\n                c.remove(c.getActiveObject());\n            }\n            eventAggregator.notify('TOOL_USAGE', CONST.TOOL.DELETE, 'inactive');\n        };\n\n        eventAggregator.subscribeTo(CONST.TOOL.DELETE, 'DeleteTool', remove);\n\n        eventAggregator.subscribeTo('keydown', 'DeleteTool', function(topic, sender, keyCode) {\n                if (keyCode === 46) {\n                    remove();\n                }\n            });\n\n        canvasWrapper.canvas.on('object:selected', function(o) {\n            eventAggregator.notify('tool-enabled', CONST.TOOL.DELETE, true);\n        });\n        canvasWrapper.canvas.on('selection:cleared', function(o) {\n            eventAggregator.notify('tool-enabled', CONST.TOOL.DELETE, false);\n        });\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/delete-tool.js\n **/","import CONST from '../canvas-const.js';\nimport Browser from '../browser-api.js';\n\n/**\n * A tool to create horizontal lines.\n */\nexport default class HorizontalLineTool {\n    /**\n     * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n     * @constructor\n     * @param {Canvas} canvasWrapper - Canvas.\n     * @param {EventAggregator} eventAggregator - Event mediator.\n     */\n    constructor(canvasWrapper, eventAggregator, toolOptions) {\n        var canvas = canvasWrapper.canvas;\n        var horizontalLine;\n        eventAggregator.subscribeTo(CONST.TOOL.HORIZONTAL_LINE, 'HorizontalLineTool', HorizontalLineTool);\n\n        function notify(message) {\n            eventAggregator.notify('TOOL_USAGE', CONST.TOOL.HORIZONTAL_LINE, message);\n        }\n\n        function createHorizontalLine() {\n\n            return new fabric.Line([0, 0, canvas.width, 0], {\n                left: 0,\n                top: 1,\n                hasControls: false,\n                lockMovementX: true,\n                opacity: 0.7,\n                padding: 4,\n                stroke: toolOptions.color,\n                strokeWidth: 2\n            });\n        }\n\n        function HorizontalLineTool(addr, sender, action) {\n            if (action !== 'toolbar-click') {\n                abort();\n                return;\n            }\n\n            notify('active');\n\n            horizontalLine = createHorizontalLine();\n            canvas.add(horizontalLine);\n\n            eventAggregator.subscribeTo('keydown', 'HorizontalLine', function(topic, sender, keyCode) {\n                if (keyCode === 27) {\n                    abort();\n                }\n            });\n\n            function abort() {\n                canvas.remove(horizontalLine);\n                horizontalLine = undefined;\n                // TODO unsubscribe\n\n                detachHorizontalLineListener();\n                notify('inactive');\n            }\n\n            var onMouseMove = function(options) {\n                if (horizontalLine) {\n                    horizontalLine.set({\n                        'top': canvas.getPointer(options.e).y\n                    });\n\n                    horizontalLine.setCoords();\n                    canvas.renderAll();\n                }\n            };\n            canvas.on('mouse:move', onMouseMove);\n\n            var onMouseUp = function(options) {\n                horizontalLine = createHorizontalLine();\n                canvas.add(horizontalLine);\n            };\n            canvas.on('mouse:up', onMouseUp);\n\n            function detachHorizontalLineListener() {\n                canvas.off('mouse:move', onMouseMove);\n                canvas.off('mouse:up', onMouseUp);\n            }\n\n        };\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/horizontal-line-tool.js\n **/","import CONST from '../canvas-const.js';\nimport Browser from '../browser-api.js';\n\n/**\n * A tool to pixelate areas.\n */\nexport default class PixelateTool {\n    /**\n     * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n     * @constructor\n     * @param {Canvas} canvasWrapper - Canvas.\n     * @param {EventAggregator} eventAggregator - Event mediator.\n     */\n    constructor(canvasWrapper, eventAggregator, toolOptions) {\n\n        eventAggregator.subscribeTo(CONST.TOOL.PIXELATE, 'PixelateTool', attachRectangleListener);\n        let rect, callbackCtx = this;\n        let startTop, startLeft;\n        let canvas = canvasWrapper.canvas;\n\n        function notify(message) {\n            eventAggregator.notify('TOOL_USAGE', CONST.TOOL.PIXELATE, message);\n        }\n\n        function done() {\n            notify('inactive');\n            detachRectangleListener();\n            canvasWrapper.enableSelection(true);\n        }\n\n        function detachRectangleListener() {\n            canvas.off('mouse:down', mouseDown);\n            canvas.off('mouse:move', drawRectangle);\n            canvas.off('mouse:up', drawRectangleDone);\n\n            rect = undefined;\n            eventAggregator.unsubscribeTo('keydown', 'PixelateTool');\n        }\n\n\n        function drawRectangle(options) {\n\n            let pointer = canvas.getPointer(options.e);\n\n            let top, left,\n              currWidth = pointer.x - startLeft,\n              currHeight = pointer.y - startTop;\n            if (currWidth < 0) {\n              left = pointer.x;\n            } else {\n              left = startLeft;\n            }\n\n            if (currHeight < 0) {\n              top = pointer.y;\n            } else {\n              top = startTop;\n            }\n\n            rect.set({\n                'top': top,\n                'left': left,\n                'width': Math.abs(currWidth),\n                'height': Math.abs(currHeight)\n            });\n\n            rect.setCoords();\n            canvas.renderAll();\n        }\n\n        function applyFilter(index, filter, obj) {\n            console.log(obj.filters, index);\n            console.log('alpha 1');\n            obj.filters[index] = filter;\n            console.log('bravo');\n            obj.applyFilters(canvas.renderAll.bind(canvas), undefined, obj.getElement());\n            console.log('charlie');\n        }\n\n        function drawRectangleDone(options) {\n            canvas.off('mouse:move', drawRectangle);\n            canvas.off('mouse:up', drawRectangleDone);\n            canvas.remove(rect);\n\n\n            let pointer = canvas.getPointer(options.e);\n            let currWidth = pointer.x - startLeft;\n            let currHeight = pointer.y - startTop;\n\n            if (Math.abs(currWidth) > 0 && Math.abs(currHeight) > 0) {\n                let object = fabric.util.object.clone(canvasWrapper.image);\n\n                let cropped = new Image();\n                cropped.src = object.toDataURL({\n                    left: rect.left,\n                    top: rect.top,\n                    width: rect.width,\n                    height: rect.height\n                });\n\n                let image = new fabric.Image(cropped);\n\n                image.set({\n                    left: rect.left,\n                    top: rect.top,\n                    width: rect.width,\n                    height: rect.height,\n                    hasControls: false,\n                    lockMovementX:true,\n                    lockMovementY:true\n                });\n\n                let f = fabric.Image.filters;\n                console.log('image', image.width, image.height)\n                applyFilter(0, new f.Pixelate({\n                    blocksize: toolOptions.blocksize\n                }), image);\n\n                image.setCoords();\n                canvas.add(image);\n                canvas.sendToBack(image);\n                canvas.renderAll();\n\n            }\n            canvas.renderAll();\n\n            rect = undefined;\n        }\n\n\n\n        function mouseDown(options) {\n            let pointer = canvas.getPointer(options.e);\n\n            startTop = pointer.y;\n            startLeft = pointer.x;\n\n            rect = new fabric.Rect({\n                left: startLeft,\n                top: startTop,\n                width: 4,\n                borderColor: toolOptions.color,\n                height: 4,\n                fill: toolOptions.color,\n                opacity: 0.3,\n                hasControls: true,\n                hasRotatingPoint:false,\n                originX:'left',\n                originY:'top',\n                selectable: false\n            });\n\n            canvas.add(rect);\n            rect.setCoords();\n            canvas.renderAll();\n            canvas.on('mouse:move', drawRectangle);\n            canvas.on('mouse:up', drawRectangleDone);\n        }\n\n        function attachRectangleListener(topic, sender, payload) {\n            if (payload === 'toolbar-deactivate'){\n                done();\n                return;\n            }\n            eventAggregator.subscribeTo('keydown', 'PixelateTool', function(topic, sender, keyCode) {\n                if (keyCode === 27) {\n                    done();\n                }\n            }, callbackCtx);\n            canvasWrapper.enableSelection(false);\n            notify('active');\n\n            canvas.on('mouse:down', mouseDown);\n        }\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/pixelate-tool.js\n **/","import CONST from '../canvas-const.js';\nimport Browser from '../browser-api.js';\n\n/** used during drag n drop */\nvar rect;\n/**\n * A tool to paint rectangles.\n */\nexport default class RectangleTool {\n    /**\n     * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n     * @constructor\n     * @param {Canvas} canvasWrapper - Canvas.\n     * @param {EventAggregator} eventAggregator - Event mediator.\n     */\n    constructor(canvasWrapper, eventAggregator, toolOptions) {\n        var currWidth, currHeight, startY, startX;\n\n        eventAggregator.subscribeTo(CONST.TOOL.RECTANGLE, 'RectangleTool', attachRectangleListener);\n        var callbackCtx = this;\n        let canvas = canvasWrapper.canvas;\n\n        function notify(message) {\n            eventAggregator.notify('TOOL_USAGE', CONST.TOOL.RECTANGLE, message);\n        }\n\n        function done() {\n            notify('inactive');\n            detachRectangleListener();\n            canvasWrapper.enableSelection(true);\n        }\n\n        function detachRectangleListener() {\n            canvas.off('mouse:down', mouseDown);\n            canvas.off('mouse:move', drawRectangle);\n            canvas.off('mouse:up', drawRectangleDone);\n\n            rect = undefined;\n            eventAggregator.unsubscribeTo('keydown', 'RectangleTool');\n        }\n\n        function drawRectangle(options) {\n\n              let pointer = canvas.getPointer(options.e);\n\n              let top, left,\n                width = pointer.x - startX,\n                height = pointer.y - startY;\n              currHeight = Math.abs(height);\n              currWidth = Math.abs(width);\n\n              if (width < 0) {\n                left = pointer.x;\n              } else {\n                left = startX;\n              }\n\n              if (height < 0) {\n                top = pointer.y;\n              } else {\n                top = startY;\n              }\n\n              rect.set({\n                  'top': top,\n                  'left': left,\n                  'width': currWidth,\n                  'height': currHeight\n              });\n\n              rect.setCoords();\n              canvas.renderAll();\n\n        }\n        function drawRectangleDone(options) {\n            canvas.off('mouse:move', drawRectangle);\n            canvas.off('mouse:up', drawRectangleDone);\n\n            if (Math.abs(currWidth) < 5 && Math.abs(currHeight) < 5) {\n                canvas.remove(rect);\n                return;\n            }\n\n            rect.set({opacity: 0.5});\n            canvas.renderAll();\n        }\n\n\n        function mouseDown(options) {\n            let pointer = canvas.getPointer(options.e);\n            currWidth = currHeight = 0;\n\n            startY = pointer.y;\n            startX = pointer.x;\n\n            rect = new fabric.Rect({\n                left: startX,\n                top: startY,\n                width: 4,\n                borderColor: toolOptions.color,\n                height: 4,\n                fill: toolOptions.color,\n                opacity: 0.3,\n                hasControls: true,\n                hasRotatingPoint:false,\n                originX:'left',\n                originY:'top',\n                selectable: false\n            });\n\n            canvas.add(rect);\n            rect.setCoords();\n            canvas.renderAll();\n            canvas.on('mouse:move', drawRectangle);\n            canvas.on('mouse:up', drawRectangleDone);\n        }\n\n        function attachRectangleListener(topic, sender, payload) {\n            if (payload === 'toolbar-deactivate'){\n                done();\n                return;\n            }\n            eventAggregator.subscribeTo('keydown', 'RectangleTool', function(topic, sender, keyCode) {\n                if (keyCode === 27) {\n                    done();\n                }\n            }, callbackCtx);\n            canvasWrapper.enableSelection(false);\n            notify('active');\n\n            canvas.on('mouse:down', mouseDown);\n        }\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/rectangle-tool.js\n **/","import CONST from '../canvas-const.js';\nimport Browser from '../browser-api.js';\n\n/**\n * A tool to reset the canvas, i.e. remove all objects.\n */\nexport default class ResetTool {\n    /**\n     * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n     * @constructor\n     * @param {Canvas} canvasWrapper - Canvas.\n     * @param {EventAggregator} eventAggregator - Event mediator.\n     */\n    constructor(canvasWrapper, eventAggregator) {\n    \teventAggregator.subscribeTo(CONST.TOOL.RESET, 'ResetTool', initClear);\n\t\tfunction initClear(topic, sender, payload) {\n\t\t\tif (payload !== 'toolbar-deactivate' &&\n\t\t\t\tconfirm('This will restore your image to its default state.\\nAll your modifications will be deleted.\\nDo you want to continue?')) {\n\t\t\t\tclearAllElements();\n\t\t\t}\n\t\t\teventAggregator.notify('TOOL_USAGE', CONST.TOOL.RESET, 'inactive');\n\t\t}\n\n\t\tfunction clearAllElements() {\n\t\t\tvar c = canvasWrapper.canvas;\n\t\t\tvar all = c.getObjects();\n\t\t\tfor (var i = all.length - 1; i >= 0; i--) {\n\t\t\t\tc.remove(all[i]);\n\t\t\t}\n\t\t}\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/reset-tool.js\n **/","import CONST from '../canvas-const.js';\nimport Browser from '../browser-api.js';\n\nvar editorHeight = 30;\n\n/**\n * A tool to create a text editor in the canvas.\n */\nexport default class TextTool {\n    /**\n     * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n     * @constructor\n     * @param {Canvas} canvasWrapper - Canvas.\n     * @param {EventAggregator} eventAggregator - Event mediator.\n     */\n    constructor(canvasWrapper, eventAggregator, toolOptions) {\n        var canvas = canvasWrapper.canvas;\n        var editor;\n        eventAggregator.subscribeTo(CONST.TOOL.TEXT, 'TextTool', textTool);\n        eventAggregator.subscribeTo('keydown', 'TextTool', function(topic, sender, keyCode) {\n            if (keyCode === 27) {\n                abort();\n            }\n        });\n\n        function notify(message) {\n            eventAggregator.notify('TOOL_USAGE', CONST.TOOL.TEXT, message);\n        }\n\n        function abort() {\n            if (editor) {\n                canvas.remove(editor);\n                editor = undefined;\n                notify('inactive');\n            }\n        }\n        function textTool(topic, sender, payload) {\n            if (payload!=='toolbar-click') {\n                abort();\n                return;\n            }\n            notify('active');\n            editor = new fabric.IText('Click to leave a comment', {\n                fontFamily: toolOptions.fontFamily,\n                fontSize: toolOptions.fontSize,\n                left: 100,\n                top: -40,\n                fill: toolOptions.color,\n                hasControls: false\n            });\n\n            canvas.add(editor);\n\n            var onMove = function(options) {\n                if (editor) {\n                    let pointer = canvas.getPointer(options.e);\n                    editor.set({\n                        'top': pointer.y,\n                        'left': pointer.x\n                    });\n                    editor.setCoords();\n                    canvas.renderAll();\n                }\n            };\n            canvas.on('mouse:move', onMove);\n\n            function detachTextListener() {\n                if (editor) {\n                    canvas.off('mouse:move', onMove);\n                    canvas.off('mouse:up', detachTextListener);\n                    editor.setCoords();\n                    editor = undefined;\n                    canvas.renderAll();\n                    notify('inactive');\n                }\n            }\n            canvas.on('mouse:up', detachTextListener);\n        }\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/text-tool.js\n **/","import CONST from '../../canvas-const.js';\nimport Browser from '../../browser-api.js';\nimport ArrowTool from '../arrow-tool.js';\n\n/**\n * Default Arrow options.\n */\nvar defaultToolProps = {\n  label: 'Arrow',\n  color: CONST.DEFAULT_COLOR,\n  activeColor: '#55f',\n  size: 15,\n  lineWidth: 4\n};\n\n(new Browser()).getFromWindow('redraw').registerTool(CONST.TOOL.ARROW, ArrowTool, defaultToolProps);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/setup/arrow-setup.js\n **/","import CONST from '../../canvas-const.js';\nimport Browser from '../../browser-api.js';\nimport DeleteTool from '../delete-tool.js';\n\n/**\n * Default Delete options.\n */\nvar defaultToolProps = {\n  label: 'Delete'\n};\n\n(new Browser()).getFromWindow('redraw').registerTool(CONST.TOOL.DELETE, DeleteTool, defaultToolProps);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/setup/delete-setup.js\n **/","import CONST from '../../canvas-const.js';\nimport Browser from '../../browser-api.js';\nimport HorizontalLineTool from '../horizontal-line-tool.js';\n\n/**\n * Default Horizontal Line options.\n */\nvar defaultToolProps = {\n  label: 'Horizontal Line',\n  color: CONST.DEFAULT_COLOR,\n  activeColor: '#55f'\n};\n\n(new Browser()).getFromWindow('redraw').registerTool(CONST.TOOL.HORIZONTAL_LINE, HorizontalLineTool, defaultToolProps);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/setup/horizontal-line-setup.js\n **/","import CONST from '../../canvas-const.js';\nimport Browser from '../../browser-api.js';\nimport PixelateTool from '../pixelate-tool.js';\n\n/**\n * Default Pixelate options.\n */\nvar defaultToolProps = {\n  label: 'Pixelate',\n  color: CONST.DEFAULT_COLOR,\n  blocksize: 8\n};\n\n(new Browser()).getFromWindow('redraw').registerTool(CONST.TOOL.PIXELATE, PixelateTool, defaultToolProps);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/setup/pixelate-setup.js\n **/","import CONST from '../../canvas-const.js';\nimport Browser from '../../browser-api.js';\nimport RectangleTool from '../rectangle-tool.js';\n\n/**\n * Default Rectangle options.\n */\nvar defaultToolProps = {\n    label: 'Rectangle',\n    color: CONST.DEFAULT_COLOR\n};\n\n(new Browser()).getFromWindow('redraw').registerTool(CONST.TOOL.RECTANGLE, RectangleTool, defaultToolProps);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/setup/rectangle-setup.js\n **/","import CONST from '../../canvas-const.js';\nimport Browser from '../../browser-api.js';\nimport ResetTool from '../reset-tool.js';\n\n/**\n * Default Reset options.\n */\nvar defaultToolProps = {\n  label: 'Reset'\n};\n\n(new Browser()).getFromWindow('redraw').registerTool(CONST.TOOL.RESET, ResetTool, defaultToolProps);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/setup/reset-setup.js\n **/","import CONST from '../../canvas-const.js';\nimport Browser from '../../browser-api.js';\nimport TextTool from '../text-tool.js';\n\n/**\n * Default Text options.\n */\nvar defaultToolProps = {\n  label: 'Text',\n  fontFamily: 'arial',\n  fontSize: 18,\n  color: CONST.DEFAULT_COLOR,\n};\n\n(new Browser()).getFromWindow('redraw').registerTool(CONST.TOOL.TEXT, TextTool, defaultToolProps);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/tools/setup/text-setup.js\n **/"],"sourceRoot":""}